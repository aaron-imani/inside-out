#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdbool.h>

typedef struct {
    char *key;
    int value;
    struct Node *next;
} Node;

typedef struct {
    Node **table;
    size_t size;
} Map;

typedef struct {
    Node *head;
} Set;

unsigned int hash(const char *str) {
    unsigned int hash = 5381;
    int c;
    while ((c = *str++))
        hash = ((hash << 5) + hash) + c;
    return hash;
}

Map* createMap(size_t size) {
    Map *map = (Map*)malloc(sizeof(Map));
    map->size = size;
    map->table = (Node**)calloc(size, sizeof(Node*));
    return map;
}

void put(Map *map, const char *key, int value) {
    unsigned int index = hash(key) % map->size;
    Node *newNode = (Node*)malloc(sizeof(Node));
    newNode->key = strdup(key);
    newNode->value = value;
    newNode->next = map->table[index];
    map->table[index] = newNode;
}

int get(Map *map, const char *key) {
    unsigned int index = hash(key) % map->size;
    Node *current = map->table[index];
    while (current != NULL) {
        if (strcmp(current->key, key) == 0)
            return current->value;
        current = current->next;
    }
    return -1; // Key not found
}

Set* createSet() {
    Set *set = (Set*)malloc(sizeof(Set));
    set->head = NULL;
    return set;
}

bool contains(Set *set, const char *key) {
    Node *current = set->head;
    while (current != NULL) {
        if (strcmp(current->key, key) == 0)
            return true;
        current = current->next;
    }
    return false;
}

void add(Set *set, const char *key) {
    if (!contains(set, key)) {
        Node *newNode = (Node*)malloc(sizeof(Node));
        newNode->key = strdup(key);
        newNode->next = set->head;
        set->head = newNode;
    }
}

bool isPalindrome(const char *s) {
    if (s == NULL) return false;
    int left = 0, right = strlen(s) - 1;
    while (left < right) {
        if (s[left++] != s[right--]) return false;
    }
    return true;
}

int calculateComplexity(const char *s) {
    if (s == NULL) return 0;
    Set *uniqueChars = createSet();
    for (int i = 0; i < strlen(s); i++) {
        add(uniqueChars, &s[i]);
    }
    int multiplier = isPalindrome(s) ? 2 : 1;
    int count = 0;
    Node *current = uniqueChars->head;
    while (current != NULL) {
        count++;
        current = current->next;
